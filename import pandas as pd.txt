import pandas as pd
import numpy as np
import streamlit as st
import matplotlib.pyplot as plt
from datetime import datetime

# ƒê·ªçc d·ªØ li·ªáu
df = pd.read_excel("thuytrieu.xlsx")
df['Phut'] = df['Gi·ªù'].apply(lambda x: int(x.split(':')[0])*60 + int(x.split(':')[1]))

def du_doan_chieu_cao(gio, phut):
    phut_trong_ngay = gio*60 + phut
    return np.interp(phut_trong_ngay, df['Phut'], df['Chi·ªÅu cao'])

st.title("üåä D·ª± b√°o th·ªßy tri·ªÅu")
ngay = st.date_input("Ch·ªçn ng√†y", datetime.now().date())
gio = st.number_input("Gi·ªù", 0, 23, 12)
phut = st.number_input("Ph√∫t", 0, 59, 0)

if st.button("T√≠nh"):
    chieu_cao = du_doan_chieu_cao(gio, phut)
    st.success(f"Chi·ªÅu cao d·ª± ƒëo√°n: {chieu_cao:.2f} m")

    # V·∫Ω bi·ªÉu ƒë·ªì
    phut_list = np.arange(0, 24*60, 10)
    cao_list = [np.interp(p, df['Phut'], df['Chi·ªÅu cao']) for p in phut_list]
    gio_list = [p/60 for p in phut_list]

    fig, ax = plt.subplots()
    ax.plot(gio_list, cao_list, marker='o')
    ax.set_xlabel("Gi·ªù")
    ax.set_ylabel("Chi·ªÅu cao (m)")
    ax.set_title(f"Bi·ªÉu ƒë·ªì th·ªßy tri·ªÅu ng√†y {ngay}")
    st.pyplot(fig)